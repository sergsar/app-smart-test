"use strict";(self.webpackChunkapp_smart_test=self.webpackChunkapp_smart_test||[]).push([[357],{8357:(Ce,X,d)=>{d.r(X),d.d(X,{CharacterListModule:()=>ve});var e=d(4893),D=d(7579),$=d(515),dt=d(1135),P=d(262),g=d(9646),pt=d(4408);const W=new(d(640).v)(pt.o),ft=W;var vt=d(8306),Ct=d(3532);var y=d(9300),h=d(4004);class N{constructor(i,t){this.cellsCount=i,this.rowsCount=t,this.cellWidth=`${Math.floor(100/this.cellsCount)}%`}}var x=d(3088),_=d(3900),f=d(4394),o=d(1174);const A="marvel-api",U=function xt(n){return i=>`${n} ${i}`}("[MARVEL CHARACTERS]"),Z=(0,o.PH)(U("Load marvel characters success"),(0,o.Ky)()),H=(0,o.PH)(U("Load marvel characters failure"),(0,o.Ky)()),tt=(0,o.PH)(U("Load marvel characters"),(0,o.Ky)()),et=(0,o.PH)(U("Load marvel character"),(0,o.Ky)()),Mt=(0,o.Lq)({state:"pending"},(0,o.on)(Z,(n,i)=>Object.assign({state:"ready"},i)),(0,o.on)(H,n=>({state:"error"}))),Q=function Lt(n){return i=>`${n} ${i}`}("[MARVEL COMICS]"),J=(0,o.PH)(Q("Load marvel character comics success"),(0,o.Ky)()),nt=(0,o.PH)(Q("Load marvel character comics failure"),(0,o.Ky)()),it=(0,o.PH)(Q("Load marvel character comics"),(0,o.Ky)()),wt=(0,o.Lq)({state:"pending"},(0,o.on)(J,(n,i)=>Object.assign({state:"ready"},i)),(0,o.on)(nt,n=>({state:"error"}))),K=function bt(n){return i=>`${n} ${i}`}("[MARVEL EVENTS]"),R=(0,o.PH)(K("Load marvel character events success"),(0,o.Ky)()),st=(0,o.PH)(K("Load marvel character events failure"),(0,o.Ky)()),rt=(0,o.PH)(K("Load marvel character events"),(0,o.Ky)()),Tt=(0,o.Lq)({state:"pending"},(0,o.on)(R,(n,i)=>Object.assign({state:"ready"},i)),(0,o.on)(st,n=>({state:"error"}))),B=function Et(n){return i=>`${n} ${i}`}("[MARVEL SERIES]"),z=(0,o.PH)(B("Load marvel character series success"),(0,o.Ky)()),ot=(0,o.PH)(B("Load marvel character series failure"),(0,o.Ky)()),Ft=(0,o.PH)(B("Load marvel character series"),(0,o.Ky)()),It=(0,o.Lq)({state:"pending"},(0,o.on)(z,(n,i)=>Object.assign({state:"ready"},i)),(0,o.on)(ot,n=>({state:"error"}))),G=function $t(n){return i=>`${n} ${i}`}("[MARVEL STORIES]"),k=(0,o.PH)(G("Load marvel character stories success"),(0,o.Ky)()),ct=(0,o.PH)(G("Load marvel character stories failure"),(0,o.Ky)()),Ut=(0,o.PH)(G("Load marvel character stories"),(0,o.Ky)()),jt=(0,o.Lq)({state:"pending"},(0,o.on)(k,(n,i)=>Object.assign({state:"ready"},i)),(0,o.on)(ct,n=>({state:"error"}))),Nt=new e.OlP("Marvel Api",{factory:()=>({characters:Mt,comics:wt,events:Tt,series:It,stories:jt})});var T=d(655),E=d(590);const V=(0,o.P1)(n=>n[A],n=>n.characters),F="https://gateway.marvel.com/v1/public";var Kt=d(520);let I=(()=>{class n{constructor(t){this.http=t}getCharacters(t){return this.http.get(`${F}/characters`,{params:Object.assign(Object.assign({},this.getAuthParams()),this.processParams(t))})}getCharacter(t){return this.http.get(`${F}/characters/${t}`,{params:Object.assign({},this.getAuthParams())})}getComics(t,s){return this.http.get(`${F}/characters/${t}/comics`,{params:Object.assign(Object.assign({},this.getAuthParams()),this.processParams(s))})}getStories(t,s){return this.http.get(`${F}/characters/${t}/stories`,{params:Object.assign(Object.assign({},this.getAuthParams()),this.processParams(s))})}getEvents(t,s){return this.http.get(`${F}/characters/${t}/events`,{params:Object.assign(Object.assign({},this.getAuthParams()),this.processParams(s))})}getSeries(t,s){return this.http.get(`${F}/characters/${t}/series`,{params:Object.assign(Object.assign({},this.getAuthParams()),this.processParams(s))})}getAuthParams(){return{ts:"1",apikey:"2640683be73eca0f74efa9274a6059d7",hash:"4800ef0902736d1b8ec875e409e093a1"}}processParams(t){if(!t)return t;let s={};return Object.keys(t).forEach(r=>{void 0!==t[r]&&(s[r]=t[r])}),s}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(Kt.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class M{constructor(i,t,s){this.actions=i,this.store=t,this.marvelApiService=s,this.characters=this.actions.pipe((0,f.l4)(tt),(0,_.w)(r=>this.store.select(V).pipe((0,E.P)(),(0,_.w)(a=>{var c,m;const v=r.offset||0,C=r.limit||(null===(c=this.cache)||void 0===c?void 0:c.length);return((null===(m=this.cache)||void 0===m?void 0:m.slice(v,v+C).filter(Boolean))||[]).length===C?(0,g.of)(Z({summary:this.summary,single:a.single})):this.getCharacters(r.offset,r.limit).pipe((0,h.U)(p=>{this.cache=this.cache?[...this.cache]:new Array(p.total);for(let u=0;u<p.count;u++)this.cache[p.offset+u]=p.results[u];return this.summary=this.cache.filter(Boolean),Z({summary:this.cache.filter(Boolean),single:a.single})}),(0,P.K)(p=>(console.error(p),(0,g.of)(H({error:p})))))})))),this.character=this.actions.pipe((0,f.l4)(et),(0,_.w)(r=>this.store.select(V).pipe((0,E.P)(),(0,_.w)(a=>{var c,m;const v=(null===(c=a.single)||void 0===c?void 0:c.find(C=>C.id===r.id))||(null===(m=a.summary)||void 0===m?void 0:m.find(C=>C.id===r.id));if(v){const C=[...a.single||[],v];return(0,g.of)(Z({summary:this.summary,single:C}))}return this.getCharacter(r.id).pipe((0,h.U)(C=>{const l=[...a.single||[],...C.results];return Z({summary:this.summary,single:l})}),(0,P.K)(C=>(console.error(C),(0,g.of)(H({error:C})))))}))))}getCharacters(i,t){return this.marvelApiService.getCharacters({offset:i,limit:t}).pipe((0,h.U)(s=>s.data))}getCharacter(i){return this.marvelApiService.getCharacter(i).pipe((0,h.U)(t=>t.data))}}M.\u0275fac=function(i){return new(i||M)(e.LFG(f.eX),e.LFG(o.yh),e.LFG(I))},M.\u0275prov=e.Yz7({token:M,factory:M.\u0275fac}),(0,T.gn)([(0,f.Qm)()],M.prototype,"characters",void 0),(0,T.gn)([(0,f.Qm)()],M.prototype,"character",void 0);const at=(0,o.P1)(n=>n[A],n=>n.comics);class L{constructor(i,t,s){this.actions=i,this.store=t,this.marvelApiService=s,this.comics=this.actions.pipe((0,f.l4)(it),(0,_.w)(r=>this.store.select(at).pipe((0,E.P)(),(0,_.w)(a=>{const c=this.cache&&this.cache[r.id]||[],m=r.offset||0,v=r.limit||c.length;return((null==c?void 0:c.slice(m,m+v).filter(Boolean))||[]).length===v?(0,g.of)(J({summary:this.summary})):this.getComics(r.id,r.offset,r.limit).pipe((0,h.U)(l=>{const p=this.cache&&this.cache[r.id]||new Array(l.total);for(let u=0;u<l.count;u++)p[l.offset+u]=l.results[u];return this.summary=Object.assign(Object.assign({},this.summary),{[r.id]:p.filter(Boolean)}),J({summary:this.summary})}),(0,P.K)(l=>(console.error(l),(0,g.of)(nt({error:l})))))}))))}getComics(i,t,s){return this.marvelApiService.getComics(i,{offset:t,limit:s}).pipe((0,h.U)(r=>r.data))}}L.\u0275fac=function(i){return new(i||L)(e.LFG(f.eX),e.LFG(o.yh),e.LFG(I))},L.\u0275prov=e.Yz7({token:L,factory:L.\u0275fac}),(0,T.gn)([(0,f.Qm)()],L.prototype,"comics",void 0);const lt=(0,o.P1)(n=>n[A],n=>n.events);class S{constructor(i,t,s){this.actions=i,this.store=t,this.marvelApiService=s,this.events=this.actions.pipe((0,f.l4)(rt),(0,_.w)(r=>this.store.select(lt).pipe((0,E.P)(),(0,_.w)(a=>{const c=this.cache&&this.cache[r.id]||[],m=r.offset||0,v=r.limit||c.length;return((null==c?void 0:c.slice(m,m+v).filter(Boolean))||[]).length===v?(0,g.of)(R({summary:this.summary})):this.getEvents(r.id,r.offset,r.limit).pipe((0,h.U)(l=>{const p=this.cache&&this.cache[r.id]||new Array(l.total);for(let u=0;u<l.count;u++)p[l.offset+u]=l.results[u];return this.summary=Object.assign(Object.assign({},a.summary),{[r.id]:p.filter(Boolean)}),R({summary:this.summary})}),(0,P.K)(l=>(console.error(l),(0,g.of)(st({error:l})))))}))))}getEvents(i,t,s){return this.marvelApiService.getEvents(i,{offset:t,limit:s}).pipe((0,h.U)(r=>r.data))}}S.\u0275fac=function(i){return new(i||S)(e.LFG(f.eX),e.LFG(o.yh),e.LFG(I))},S.\u0275prov=e.Yz7({token:S,factory:S.\u0275fac}),(0,T.gn)([(0,f.Qm)()],S.prototype,"events",void 0);const Rt=(0,o.P1)(n=>n[A],n=>n.stories);class w{constructor(i,t,s){this.actions=i,this.store=t,this.marvelApiService=s,this.stories=this.actions.pipe((0,f.l4)(Ut),(0,_.w)(r=>this.store.select(Rt).pipe((0,E.P)(),(0,_.w)(a=>{const c=this.cache&&this.cache[r.id]||[],m=r.offset||0,v=r.limit||c.length;return((null==c?void 0:c.slice(m,m+v).filter(Boolean))||[]).length===v?(0,g.of)(k({summary:this.summary})):this.getStories(r.id,r.offset,r.limit).pipe((0,h.U)(l=>{const p=this.cache&&this.cache[r.id]||new Array(l.total);for(let u=0;u<l.count;u++)p[l.offset+u]=l.results[u];return this.summary=Object.assign(Object.assign({},a.summary),{[r.id]:p.filter(Boolean)}),k({summary:this.summary})}),(0,P.K)(l=>(console.error(l),(0,g.of)(ct({error:l})))))}))))}getStories(i,t,s){return this.marvelApiService.getStories(i,{offset:t,limit:s}).pipe((0,h.U)(r=>r.data))}}w.\u0275fac=function(i){return new(i||w)(e.LFG(f.eX),e.LFG(o.yh),e.LFG(I))},w.\u0275prov=e.Yz7({token:w,factory:w.\u0275fac}),(0,T.gn)([(0,f.Qm)()],w.prototype,"stories",void 0);const Bt=(0,o.P1)(n=>n[A],n=>n.series);class b{constructor(i,t,s){this.actions=i,this.store=t,this.marvelApiService=s,this.series=this.actions.pipe((0,f.l4)(Ft),(0,_.w)(r=>this.store.select(Bt).pipe((0,E.P)(),(0,_.w)(a=>{const c=this.cache&&this.cache[r.id]||[],m=r.offset||0,v=r.limit||c.length;return((null==c?void 0:c.slice(m,m+v).filter(Boolean))||[]).length===v?(0,g.of)(z({summary:this.summary})):this.getSeries(r.id,r.offset,r.limit).pipe((0,h.U)(l=>{const p=this.cache&&this.cache[r.id]||new Array(l.total);for(let u=0;u<l.count;u++)p[l.offset+u]=l.results[u];return this.summary=Object.assign(Object.assign({},a.summary),{[r.id]:p.filter(Boolean)}),z({summary:this.summary})}),(0,P.K)(l=>(console.error(l),(0,g.of)(ot({error:l})))))}))))}getSeries(i,t,s){return this.marvelApiService.getSeries(i,{offset:t,limit:s}).pipe((0,h.U)(r=>r.data))}}b.\u0275fac=function(i){return new(i||b)(e.LFG(f.eX),e.LFG(o.yh),e.LFG(I))},b.\u0275prov=e.Yz7({token:b,factory:b.\u0275fac}),(0,T.gn)([(0,f.Qm)()],b.prototype,"series",void 0);let zt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[f.sQ.forFeature([M,L,S,w,b]),o.Aw.forFeature(A,Nt)]]}),n})();function Y(n,i){const t=[],s=Math.ceil(n.length/i.cellsCount);for(let r=0;r<s;r++){const a=i.cellsCount*r,c=n.slice(a,a+i.cellsCount),m=new Array(i.cellsCount);Object.assign(m,c),t[r]=m}return t}let q=(()=>{class n{constructor(t){this.store=t}getCharacter(t){return this.store.dispatch(et({id:t})),this.getStoreCharacter(t).pipe((0,h.U)(s=>this.convertToCharacter(s)))}getCharactersNext(t,s){let r=[];return s.pipe((0,_.w)(()=>(this.store.dispatch(tt({offset:r.length,limit:3*t.cellsCount})),this.getStoreCharacters().pipe((0,h.U)(a=>(r=a,console.log("Characters"),console.log(a),Y(this.convertToCharacters(a),t))),(0,P.K)(a=>(console.error(a),(0,g.of)(Y(this.convertToCharacters(r),t))))))))}getStoreCharacter(t){return this.getStoreCharactersState().pipe((0,h.U)(s=>{var r;return null===(r=s.single)||void 0===r?void 0:r.find(a=>a.id===t)}),(0,y.h)(s=>!!s))}getStoreCharacters(){return this.getStoreCharactersState().pipe((0,h.U)(t=>t.summary),(0,y.h)(t=>!!t))}getStoreCharactersState(){return this.store.select(V).pipe((0,y.h)(t=>"pending"!==t.state),(0,h.U)(t=>{if("error"===t.state)throw t.error;return t}))}convertToCharacters(t){return t.map(s=>this.convertToCharacter(s))}convertToCharacter(t){return{id:t.id,name:t.name,description:t.description,thumbnail:{extension:t.thumbnail.extension,path:t.thumbnail.path},comics:t.comics,events:t.events,series:t.series,stories:t.stories}}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(o.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})(),j=(()=>{class n{get isPortrait(){return document.body.clientWidth/window.innerHeight<1}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var O=d(9808);function Gt(n,i){if(1&n&&(e.TgZ(0,"div",5)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(null==t.model?null:t.model.description)}}let kt=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-character-list-item"]],inputs:{model:"model"},decls:7,vars:3,consts:[[1,"container"],[1,"item","image"],["onerror","this.onerror=null; this.src='/assets/img/default-character.jpeg'",3,"src"],[1,"item","text","name"],["class","item text description",4,"ngIf"],[1,"item","text","description"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",2),e.qZA(),e.TgZ(3,"div",3)(4,"p"),e._uU(5),e.qZA()(),e.YNc(6,Gt,3,1,"div",4),e.qZA()),2&t&&(e.xp6(2),e.Q6J("src",(null==s.model||null==s.model.thumbnail?null:s.model.thumbnail.path)+"/standard_fantastic."+(null==s.model||null==s.model.thumbnail?null:s.model.thumbnail.extension),e.LSH),e.xp6(3),e.Oqu(null==s.model?null:s.model.name),e.xp6(1),e.Q6J("ngIf",null==s.model?null:s.model.description))},directives:[O.O5],styles:["[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;align-items:stretch}[_nghost-%COMP%]   .item[_ngcontent-%COMP%]{color:#fff;display:flex}[_nghost-%COMP%]   .item.text[_ngcontent-%COMP%]{text-align:left;padding:0 16px;-webkit-box-orient:vertical;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:4}[_nghost-%COMP%]   .item.name[_ngcontent-%COMP%]{font-size:initial;min-height:7%}[_nghost-%COMP%]   .item.description[_ngcontent-%COMP%]{font-size:small;min-height:30%}[_nghost-%COMP%]   .item.image[_ngcontent-%COMP%]{height:60%;padding:8px}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;align-self:start}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;object-fit:cover;object-position:top}"],changeDetection:0}),n})();const Vt=["list"];function qt(n,i){if(1&n&&e._UZ(0,"marvel-character-list-item",8),2&n){const t=e.oxw().$implicit;e.Q6J("model",t)}}function Xt(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw(3).click(a.id)}),e.YNc(1,qt,1,1,"marvel-character-list-item",7),e.qZA()}if(2&n){const t=i.$implicit,s=e.oxw(3);e.Udp("width",s.dimensions.cellWidth),e.xp6(1),e.Q6J("ngIf",t)}}function Dt(n,i){if(1&n&&(e.TgZ(0,"div",4),e.YNc(1,Xt,2,3,"div",5),e.qZA()),2&n){const t=i.$implicit;e.Udp("max-height","1000px"),e.xp6(1),e.Q6J("ngForOf",t)}}function Wt(n,i){if(1&n&&(e.TgZ(0,"div",1,2),e.YNc(2,Dt,2,3,"div",3),e.qZA()),2&n){const t=i.ngIf;e.xp6(2),e.Q6J("ngForOf",t)}}let te=(()=>{class n{constructor(t,s,r,a){this.router=t,this.route=s,this.characterListService=r,this.viewportInfoService=a,this.destroy$=new D.x,this.endScroll$=$.E,this.endScroll=!1,this.loadNextCharacters$=new dt.X(void 0);const c=a.isPortrait;console.log("portrait: ",c),this.dimensions=new N(c?1:4,c?2:1),console.log("dimensions: ",this.dimensions),this.model$=this.characterListService.getCharactersNext(this.dimensions,this.loadNextCharacters$).pipe((0,P.K)(m=>(console.error(m),(0,g.of)([])))),this.endScroll$=function Pt(n=0,i=W){return n<0&&(n=0),function Ot(n=0,i,t=ft){let s=-1;return null!=i&&((0,Ct.K)(i)?t=i:s=i),new vt.y(r=>{let a=function _t(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;a<0&&(a=0);let c=0;return t.schedule(function(){r.closed||(r.next(c++),0<=s?this.schedule(void 0,s):r.complete())},a)})}(n,n,i)}(1e3).pipe((0,y.h)(()=>this.endScroll),(0,h.U)(()=>{this.endScroll=!1})),this.endScroll$.subscribe(()=>{this.loadNextCharacters$.next()})}scroll(){var t;this.endScroll=window.innerHeight+window.scrollY>=2*(null===(t=this.list)||void 0===t?void 0:t.nativeElement.clientHeight)/3}ngOnDestroy(){this.destroy$.next()}click(t){this.router.navigate(["character",t],{relativeTo:this.route.parent})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x.F0),e.Y36(x.gz),e.Y36(q),e.Y36(j))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-character-list"]],viewQuery:function(t,s){if(1&t&&e.Gf(Vt,5,e.SBq),2&t){let r;e.iGM(r=e.CRH())&&(s.list=r.first)}},hostBindings:function(t,s){1&t&&e.NdJ("scroll",function(a){return s.scroll(a)},!1,e.evT)},decls:2,vars:3,consts:[["class","list",4,"ngIf"],[1,"list"],["list",""],["class","row",3,"max-height",4,"ngFor","ngForOf"],[1,"row"],["class","cell",3,"width","click",4,"ngFor","ngForOf"],[1,"cell",3,"click"],[3,"model",4,"ngIf"],[3,"model"]],template:function(t,s){1&t&&(e.YNc(0,Wt,3,1,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,s.model$))},directives:[O.O5,O.sg,kt],pipes:[O.Ov],styles:["[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{margin:1px}[_nghost-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover{border:1px solid lightgreen}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{flex:1 0 auto;margin:2px}"],changeDetection:0}),n})(),ee=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-character-board"]],decls:1,vars:0,template:function(t,s){1&t&&e._UZ(0,"router-outlet")},directives:[x.lC],styles:[""],changeDetection:0}),n})();function ne(n,i){if(1&n&&(e.TgZ(0,"div",12)(1,"p"),e._uU(2),e.qZA()()),2&n){const t=e.oxw().ngIf;e.xp6(2),e.Oqu(null==t?null:t.description)}}function ie(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).changeList("events")}),e._uU(1,"Events"),e.qZA()}if(2&n){const t=e.oxw(2);e.ekj("selected","events"===t.tab)}}function se(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2),e._UZ(2,"img",3),e.TgZ(3,"div",4)(4,"h1",5),e._uU(5),e.qZA(),e.YNc(6,ne,3,1,"div",6),e.TgZ(7,"div",7)(8,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().changeList("comics")}),e._uU(9,"Comics"),e.qZA(),e.TgZ(10,"button",9),e._uU(11,"Stories"),e.qZA(),e.YNc(12,ie,2,2,"button",10),e.TgZ(13,"button",9),e._uU(14,"Series"),e.qZA()()(),e.TgZ(15,"img",11),e.NdJ("click",function(){return e.CHM(t),e.oxw().home()}),e.qZA()(),e._UZ(16,"router-outlet"),e.qZA()}if(2&n){const t=i.ngIf,s=e.oxw();e.xp6(2),e.Q6J("src",(null==t||null==t.thumbnail?null:t.thumbnail.path)+"/standard_medium."+(null==t||null==t.thumbnail?null:t.thumbnail.extension),e.LSH),e.xp6(3),e.Oqu(t.name),e.xp6(1),e.Q6J("ngIf",null==t?null:t.description),e.xp6(2),e.ekj("selected","comics"===s.tab),e.xp6(4),e.Q6J("ngIf",null==t||null==t.events||null==t.events.items?null:t.events.items.length)}}let re=(()=>{class n{constructor(t,s,r){this.route=t,this.router=s,this.characterListService=r,this.model$=$.E,this.destroy$=new D.x}get tab(){var t,s;return null===(s=null===(t=this.route.firstChild)||void 0===t?void 0:t.snapshot)||void 0===s?void 0:s.url[0].path}ngOnInit(){this.id=+this.route.snapshot.paramMap.get("id"),this.model$=this.characterListService.getCharacter(this.id)}ngOnDestroy(){this.destroy$.next()}changeList(t){console.log(this.tab),this.router.navigate([t],{relativeTo:this.route})}home(){console.log("home"),this.router.navigate([""])}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x.gz),e.Y36(x.F0),e.Y36(q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-character"]],decls:2,vars:3,consts:[["class","container",4,"ngIf"],[1,"container"],[1,"header"],["onerror","this.onerror=null; this.src='/assets/img/default-character.jpeg'",1,"item",3,"src"],[1,"about"],[1,"item","text","name"],["class","item text description",4,"ngIf"],[1,"buttons"],[1,"button",3,"click"],[1,"button"],["class","button",3,"selected","click",4,"ngIf"],["src","/assets/img/home-icon.jpeg",1,"item","home",3,"click"],[1,"item","text","description"]],template:function(t,s){1&t&&(e.YNc(0,se,17,6,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,s.model$))},directives:[O.O5,x.lC],pipes:[O.Ov],styles:["[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{color:#fff}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;flex-direction:row;margin:12px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .about[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:8px}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-top:0;margin-bottom:auto}[_nghost-%COMP%]   .header[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-size:small;width:100%}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{align-self:start;height:60%;object-fit:cover;object-position:top}[_nghost-%COMP%]   .home[_ngcontent-%COMP%]{width:25px;margin-right:0;margin-left:auto;vertical-align:top}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:hover, [_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{border:1px solid lightgreen}[_nghost-%COMP%]   .button[_ngcontent-%COMP%]{background-color:transparent;border:none;color:#fff;padding:8px;text-align:center;border-radius:12px;box-shadow:0 0 3px gray;margin-right:8px}"]}),n})(),ht=(()=>{class n{constructor(t){this.store=t}getCharacterComicsNext(t,s,r){let a=[];return r.pipe((0,_.w)(()=>(this.store.dispatch(it({offset:a.length,limit:3*s.cellsCount,id:t})),this.getStoreComics(t).pipe((0,h.U)(c=>(a=c,console.log("Comics"),console.log(c),Y(this.convertToComics(c),s)))))))}getStoreComics(t){return this.getStoreComicsState().pipe((0,h.U)(s=>s.summary[t]),(0,y.h)(s=>!!s))}getStoreComicsState(){return this.store.select(at).pipe((0,y.h)(t=>"pending"!==t.state),(0,h.U)(t=>{if("error"===t.state)throw t.error;return t}))}convertToComics(t){return t.map(s=>({id:s.id,title:s.title,description:s.description,thumbnail:s.thumbnail}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(o.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function oe(n,i){if(1&n&&(e.TgZ(0,"div",5),e._UZ(1,"div",6),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("innerHTML",null==t.model?null:t.model.description,e.oJD)}}let mt=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-comics-list-item"]],inputs:{model:"model"},decls:7,vars:3,consts:[[1,"container"],[1,"item","image"],["onerror","this.onerror=null; this.src='/assets/img/default-comics.jpeg'",3,"src"],[1,"item","text","title"],["class","item text description",4,"ngIf"],[1,"item","text","description"],[3,"innerHTML"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._UZ(2,"img",2),e.qZA(),e.TgZ(3,"div",3)(4,"p"),e._uU(5),e.qZA()(),e.YNc(6,oe,2,1,"div",4),e.qZA()),2&t&&(e.xp6(2),e.Q6J("src",(null==s.model||null==s.model.thumbnail?null:s.model.thumbnail.path)+"/landscape_xlarge."+(null==s.model||null==s.model.thumbnail?null:s.model.thumbnail.extension),e.LSH),e.xp6(3),e.Oqu(null==s.model?null:s.model.title),e.xp6(1),e.Q6J("ngIf",null==s.model?null:s.model.description))},directives:[O.O5],styles:["[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;align-items:stretch}[_nghost-%COMP%]   .item[_ngcontent-%COMP%]{color:#fff;display:flex}[_nghost-%COMP%]   .item.text[_ngcontent-%COMP%]{text-align:left;padding:0 16px;-webkit-box-orient:vertical;display:-webkit-box;text-overflow:ellipsis;-webkit-line-clamp:4}[_nghost-%COMP%]   .item.title[_ngcontent-%COMP%]{font-size:initial;min-height:7%}[_nghost-%COMP%]   .item.description[_ngcontent-%COMP%]{font-size:small;min-height:70%}[_nghost-%COMP%]   .item.image[_ngcontent-%COMP%]{height:60%;padding:8px}[_nghost-%COMP%]   p[_ngcontent-%COMP%]{margin:0;padding:0;align-self:start}[_nghost-%COMP%]   img[_ngcontent-%COMP%]{width:100%;object-fit:cover;object-position:top}"],changeDetection:0}),n})();function ce(n,i){if(1&n&&e._UZ(0,"marvel-comics-list-item",8),2&n){const t=e.oxw().$implicit;e.Q6J("model",t)}}function ae(n,i){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,ce,1,1,"marvel-comics-list-item",7),e.qZA()),2&n){const t=i.$implicit,s=e.oxw(3);e.Udp("width",s.dimensions.cellWidth),e.xp6(1),e.Q6J("ngIf",t)}}function le(n,i){if(1&n&&(e.TgZ(0,"div",4),e.YNc(1,ae,2,3,"div",5),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function he(n,i){if(1&n&&(e.TgZ(0,"div",1,2),e.YNc(2,le,2,1,"div",3),e.qZA()),2&n){const t=i.ngIf;e.xp6(2),e.Q6J("ngForOf",t)}}let me=(()=>{class n{constructor(t,s,r){var a;this.viewportInfoService=t,this.comicsListService=s,this.activatedRoute=r,this.model$=$.E;const c=t.isPortrait;console.log("portrait: ",c),this.dimensions=new N(c?1:4,c?2:1),this.characterId=+(null===(a=this.activatedRoute.parent)||void 0===a?void 0:a.snapshot.paramMap.get("id"))}ngOnInit(){this.model$=this.comicsListService.getCharacterComicsNext(this.characterId,this.dimensions,(0,g.of)(void 0)).pipe((0,P.K)(t=>(console.error(t),(0,g.of)([]))))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(j),e.Y36(ht),e.Y36(x.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-comics-list"]],decls:2,vars:3,consts:[["class","list",4,"ngIf"],[1,"list"],["list",""],["class","row",4,"ngFor","ngForOf"],[1,"row"],["class","cell",3,"width",4,"ngFor","ngForOf"],[1,"cell"],[3,"model",4,"ngIf"],[3,"model"]],template:function(t,s){1&t&&(e.YNc(0,he,3,1,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,s.model$))},directives:[O.O5,O.sg,mt],pipes:[O.Ov],styles:["[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{margin:1px}[_nghost-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{flex:1 0 auto;margin:2px}"]}),n})(),ut=(()=>{class n{constructor(t){this.store=t}getCharacterEventsNext(t,s,r){let a=[];return r.pipe((0,_.w)(()=>(this.store.dispatch(rt({offset:a.length,limit:3*s.cellsCount,id:t})),this.getStoreEvents(t).pipe((0,h.U)(c=>(a=c,console.log("Events"),console.log(c),Y(this.convertToEvent(c),s)))))))}getStoreEvents(t){return this.getStoreEventsState().pipe((0,h.U)(s=>s.summary[t]),(0,y.h)(s=>!!s))}getStoreEventsState(){return this.store.select(lt).pipe((0,y.h)(t=>"pending"!==t.state),(0,h.U)(t=>{if("error"===t.state)throw t.error;return t}))}convertToEvent(t){return t.map(s=>({id:s.id,title:s.title,description:s.description,thumbnail:s.thumbnail}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(o.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();function ue(n,i){if(1&n&&e._UZ(0,"marvel-comics-list-item",8),2&n){const t=e.oxw().$implicit;e.Q6J("model",t)}}function de(n,i){if(1&n&&(e.TgZ(0,"div",6),e.YNc(1,ue,1,1,"marvel-comics-list-item",7),e.qZA()),2&n){const t=i.$implicit,s=e.oxw(3);e.Udp("width",s.dimensions.cellWidth),e.xp6(1),e.Q6J("ngIf",t)}}function pe(n,i){if(1&n&&(e.TgZ(0,"div",4),e.YNc(1,de,2,3,"div",5),e.qZA()),2&n){const t=i.$implicit;e.xp6(1),e.Q6J("ngForOf",t)}}function ge(n,i){if(1&n&&(e.TgZ(0,"div",1,2),e.YNc(2,pe,2,1,"div",3),e.qZA()),2&n){const t=i.ngIf;e.xp6(2),e.Q6J("ngForOf",t)}}const fe=[{path:"",component:ee,children:[{path:"character-list",component:te},{path:"character/:id",component:re,children:[{path:"comics",component:me},{path:"events",component:(()=>{class n{constructor(t,s,r){var a;this.viewportInfoService=t,this.eventsListService=s,this.activatedRoute=r,this.model$=$.E;const c=t.isPortrait;console.log("portrait: ",c),this.dimensions=new N(c?1:4,c?2:1),this.characterId=+(null===(a=this.activatedRoute.parent)||void 0===a?void 0:a.snapshot.paramMap.get("id"))}ngOnInit(){this.model$=this.eventsListService.getCharacterEventsNext(this.characterId,this.dimensions,(0,g.of)(void 0)).pipe((0,P.K)(t=>(console.error(t),(0,g.of)([]))))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(j),e.Y36(ut),e.Y36(x.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marvel-events-list"]],decls:2,vars:3,consts:[["class","list",4,"ngIf"],[1,"list"],["list",""],["class","row",4,"ngFor","ngForOf"],[1,"row"],["class","cell",3,"width",4,"ngFor","ngForOf"],[1,"cell"],[3,"model",4,"ngIf"],[3,"model"]],template:function(t,s){1&t&&(e.YNc(0,ge,3,1,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,s.model$))},directives:[O.O5,O.sg,mt],pipes:[O.Ov],styles:["[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{margin:1px}[_nghost-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;flex-direction:row}[_nghost-%COMP%]   .cell[_ngcontent-%COMP%]{flex:1 0 auto;margin:2px}"]}),n})()},{path:"**",pathMatch:"full",redirectTo:"comics"}]},{path:"**",pathMatch:"full",redirectTo:"character-list"}]}];let ve=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[q,j,ht,ut],imports:[[x.Bz.forChild(fe),zt,O.ez]]}),n})()}}]);